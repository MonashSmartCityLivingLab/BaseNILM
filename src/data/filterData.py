#######################################################################################################################
#######################################################################################################################
# Title:        BaseNILM toolkit for energy disaggregation
# Topic:        Non-intrusive load monitoring utilising machine learning, pattern matching and source separation
# File:         filterData
# Date:         23.05.2024
# Author:       Dr. Pascal A. Schirmer
# Version:      V.1.0
# Copyright:    Pascal Schirmer
#######################################################################################################################
#######################################################################################################################

#######################################################################################################################
# Function Description
#######################################################################################################################
"""
This function filters the data using a median filter with a defined window length. The function can arbitrary be
applied to input or output data with different window lengths.
TODO: Additional filter methods should be implemented including zero-phase shift filters.
Inputs:     1) data:    input data
            2) method:  filtering method
            3) window:  length of the filtering window
Outputs:    1) data:    filtered data
"""

#######################################################################################################################
# Import libs
#######################################################################################################################
# ==============================================================================
# Internal
# ==============================================================================

# ==============================================================================
# External
# ==============================================================================
from scipy import signal


#######################################################################################################################
# Function
#######################################################################################################################
def filterData(data, method, window):
    ###################################################################################################################
    # MSG IN
    ###################################################################################################################
    print("INFO: Filtering data")

    ###################################################################################################################
    # Calculation
    ###################################################################################################################
    # ==============================================================================
    # Median Filter
    # ==============================================================================
    if method == 1:
        for name in data:
            data[name] = signal.medfilt(data[name], kernel_size=window)

    ###################################################################################################################
    # Return
    ###################################################################################################################
    return data
